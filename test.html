<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer Page</title>
</head>
<body>

<h1>Timer:</h1>
<p id="timer">00:00:00</p>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
<script>
    // Inisialisasi Firebase
const firebaseConfig = {
    apiKey: "AIzaSyBe7G6rFovAklTKNTmFb1TSogsiYDy_WO4",
  authDomain: "andrepid.firebaseapp.com",
  databaseURL: "https://andrepid-default-rtdb.firebaseio.com",
  projectId: "andrepid",
  storageBucket: "andrepid.appspot.com",
  messagingSenderId: "475106414273",
  appId: "1:475106414273:web:5921db06c2580738724e40",
  measurementId: "G-HTMHQWX8B6"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

let startTime;
let endTime;

// Fungsi untuk memulai timer
function startTimer() {
    startTime = new Date().getTime();
    setInterval(updateTimer, 1000);
}

// Fungsi untuk mengupdate timer setiap detik
function updateTimer() {
    let currentTime = new Date().getTime();
    let elapsedTime = currentTime - startTime;
    
    let hours = Math.floor(elapsedTime / (1000 * 60 * 60));
    let minutes = Math.floor((elapsedTime % (1000 * 60 * 60)) / (1000 * 60));
    let seconds = Math.floor((elapsedTime % (1000 * 60)) / 1000);

    document.getElementById("timer").innerText = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
}

// Fungsi untuk menyimpan waktu yang dihabiskan ke Firebase
function saveTimeSpent(time) {
    database.ref('timeSpent').push({
        time: time
    });
}

// Mulai timer ketika halaman dimuat
window.onload = function() {
    startTimer();

    // Simpan waktu yang dihabiskan saat pengguna meninggalkan halaman
    window.onbeforeunload = function() {
        endTime = new Date().getTime();
        let timeSpent = (endTime - startTime) / 1000; // Konversi ke detik
        saveTimeSpent(timeSpent);
    }
}

</script>

</body>
</html>
